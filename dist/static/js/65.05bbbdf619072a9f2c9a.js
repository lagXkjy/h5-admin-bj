webpackJsonp([65],{"7bS4":function(t,i,a){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var e=a("//Fk"),n=a.n(e),l=a("woOf"),o=a.n(l),s=a("mvHQ"),c=a.n(s),d=a("fZjL"),u=a.n(d),r=a("0LZo"),f=a("yUdk"),p=a("VTbc"),y={name:"difficultyConfig",data:function(){return{dialog_facilityName:"",dialog_facilityType:"",dialog_sportType:"",dialog_unitMap:{},levels:[],difficultyConfigTable:[],dialogVisible:!1,isLoadingConig:!1}},watch:{dialog_unitMap:function(t){}},components:{SubTitle:r.a},computed:{planTypeId:function(){return this.$route.query.planTypeId},planType:function(){return this.$route.query.planType}},methods:{verifyValue:function(t){return!!/^(\+|\-)(\d)+$/.test(t)||(this.$notify.error('请以"+"或"-"开头拼接数字的格式输入,如:+10'),!1)},yieldParms:function(t){var i=this,a=!0,e=[];return u()(t).forEach(function(n,l){a&&t[n].unitModifyDetailList.forEach(function(l,o){if(a){var s={};s.planTypeId=i.planTypeId,s.planRankId=t[n].planRankId,s.facilityName=i.dialog_facilityName,s.facilityType=i.dialog_facilityType,s.sportType=i.dialog_sportType,s.unitId=l.unitId,i.verifyValue(l.changeData)?(s.unitValue=l.changeData,e.push(s)):a=!1}})}),!!a&&c()(e)},editConig:function(t){this.dialog_facilityName=t.facilityName,this.dialog_facilityType=t.facilityType,this.dialog_sportType=t.sportType,this.dialog_unitMap=JSON.parse(c()(o()({},t.planRankUnitVoMap))),this.dialogVisible=!0},confirmUpdate:function(){var t=this,i=this.yieldParms(this.dialog_unitMap);i&&(this.dialogVisible=!1,Object(f.l)({param:i}).then(function(i){if(200==i.data.code)return t.$notify.success("编辑强度配置成功"),void t.fetchConfig();t.$notify.error("编辑强度配置失败")}).catch(function(){t.$notify.success("编辑强度配置失败")}))},handleClose:function(t){t()},fetchLevel:function(){var t=this;return new n.a(function(i,a){Object(p.a)().then(function(e){200==e.data.code?(t.levels=e.data.data.list,i()):a()}).catch(function(){a()})})},fetchConfig:function(){var t=this;this.isLoadingConig=!0,Object(f.d)({planTypeId:this.planTypeId}).then(function(i){t.difficultyConfigTable=i.data.data?i.data.data:[],t.isLoadingConig=!1}).catch(function(){t.isLoadingConig=!1})}},mounted:function(){var t=this;this.$nextTick(function(){t.fetchLevel(),t.fetchConfig()})}},_={render:function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("div",{staticClass:"difficultyConfigPage"},[a("sub-title",{attrs:{title:"训练难度设置"}}),t._v(" "),a("div",{staticClass:"planType"},[t._v("训练类型: "+t._s(t.planType))]),t._v(" "),a("div",{staticClass:"configTip"},[t._v("注：此处的难度设置是浮动值")]),t._v(" "),a("el-dialog",{attrs:{title:"强度设置",visible:t.dialogVisible,width:"50%",center:"","before-close":t.handleClose},on:{"update:visible":function(i){t.dialogVisible=i}}},[a("div",{staticClass:"dialog_item"},[a("div",{staticClass:"dialog_subtitle"},[t._v("设备名称")]),t._v(" "),a("el-input",{staticStyle:{width:"250px"},attrs:{disabled:""},model:{value:t.dialog_facilityName,callback:function(i){t.dialog_facilityName=i},expression:"dialog_facilityName"}})],1),t._v(" "),t._l(t.dialog_unitMap,function(i,e,n){return a("div",{key:n,staticClass:"dialog_item"},[a("div",{staticClass:"dialog_subtitle"},[t._v(t._s(e))]),t._v(" "),t._l(i.unitModifyDetailList,function(i,e){return a("div",{key:e,staticClass:"dialog_subItem"},[a("span",[t._v(t._s(i.unitName)+":")]),t._v(" "),a("el-input",{staticStyle:{width:"170px"},attrs:{placeholder:"输入如:+10"},model:{value:i.changeData,callback:function(a){t.$set(i,"changeData",a)},expression:"item.changeData"}},[a("template",{slot:"append"},[t._v(t._s(i.unitSymbol))])],2)],1)})],2)}),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(i){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.confirmUpdate}},[t._v("确 定")])],1)],2),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoadingConig,expression:"isLoadingConig"}],staticStyle:{width:"100%"},attrs:{data:t.difficultyConfigTable}},[a("el-table-column",{attrs:{label:"分类",prop:"sportType"},scopedSlots:t._u([{key:"default",fn:function(i){return[t._v("\n        "+t._s(1==i.row.sportType?"无氧设备":"有氧设备")+"\n      ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"设备名称",prop:"facilityName"}}),t._v(" "),t._l(t.levels,function(i,e){return a("el-table-column",{key:e,attrs:{label:i.strengthLv},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.planRankUnitVoMap[i.strengthLv].unitModifyDetailList,function(i,e){return a("div",{key:e},[a("span",[t._v(t._s(i.unitName)+":")]),a("span",[t._v(t._s(i.changeData?i.changeData:"0"))]),a("span",[t._v(t._s(i.unitSymbol))])])})}}])})}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(i){return[a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(a){t.editConig(i.row)}}},[t._v("编辑")])]}}])})],2)],1)},staticRenderFns:[]};var g=a("VU/8")(y,_,!1,function(t){a("U6t0")},"data-v-13141430",null);i.default=g.exports},U6t0:function(t,i){}});
//# sourceMappingURL=65.05bbbdf619072a9f2c9a.js.map