webpackJsonp([54],{"/QEg":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("0LZo"),s=a("RyKi");function n(e){return s.a.post("admin/store/getListByParamEncourage",e)}function r(e){return s.a.post("admin/store/addEncourage",e)}function o(e){return s.a.post("admin/store/updateEncourage",e)}var l={data:function(){return{currentPage:1,curPageSize:10,curTotal:0,otherId:"",pageSizes:[10,20,30,40],defaultPhrase:[],showtime:[],newPhrase:"",defaultVisible:!1,otherVisible:!1,phrases:[],isCreate:!1,isLoading:!1,editingDefaultPhraseContent:""}},computed:{defaultId:function(){return this.defaultPhrase[0].id?this.defaultPhrase[0].id:null},selectedDate:function(){return this.showtime[0].split(" ")[0]}},components:{SubTitle:i.a},methods:{remove:function(e){var t,a=this;confirm("确定要删除吗?")&&(t={id:e.id},s.a.post("admin/store/delEncourage",t)).then(function(e){200==e.data.code?(a.$notify.success("删除成功"),a.fetchData()):a.$notify.error("删除失败, 请重试")}).catch(function(){a.$notify.error("删除失败, 请重试")})},editDefaultPhraseContent:function(e){this.editingDefaultPhraseContent=e.encourageContent?e.encourageContent:"",this.defaultVisible=!0},editDefault:function(){var e=this;this.defaultId?o({id:this.defaultId,encourageContent:this.editingDefaultPhraseContent,isDefault:1,adminId:this.$store.state.auth.userInformation.id}).then(function(t){if(200==t.data.code)return e.$notify.success("编辑激励语成功"),e.fetchDefaultData(),void(e.defaultVisible=!1);e.$notify.error("编辑激励语失败"),e.defaultVisible=!1}).catch(function(){e.$notify.error("编辑激励语失败"),e.defaultVisible=!1}):r({encourageContent:this.editingDefaultPhraseContent,isDefault:1,adminId:this.$store.state.auth.userInformation.id}).then(function(t){if(200==t.data.code)return e.$notify.success("编辑激励语成功"),e.fetchDefaultData(),void(e.defaultVisible=!1);e.$notify.error("编辑激励语失败"),e.defaultVisible=!1}).catch(function(){e.$notify.error("编辑激励语失败"),e.defaultVisible=!1})},confirmCreate:function(){var e=this;this.verify()&&(this.isCreate?r({startTime:this.showtime[0],endTime:this.showtime[1],encourageContent:this.newPhrase,isDefault:0,adminId:this.$store.state.auth.userInformation.id}).then(function(t){if(200==t.data.code)return e.$notify.success("新建激励语成功"),e.fetchData(),void(e.otherVisible=!1);e.$notify.error("新建激励语失败"),e.otherVisible=!1}).catch(function(){e.$notify.error("新建激励语失败"),e.otherVisible=!1}):o({id:this.otherId,startTime:this.showtime[0],endTime:this.showtime[1],encourageContent:this.newPhrase,isDefault:0,adminId:this.$store.state.auth.userInformation.id}).then(function(t){if(200==t.data.code)return e.$notify.success("编辑激励语成功"),e.fetchData(),void(e.otherVisible=!1);e.$notify.error("编辑激励语失败"),e.otherVisible=!1}).catch(function(){e.$notify.error("编辑激励语失败"),e.otherVisible=!1}))},createPhrase:function(){this.otherVisible=!0,this.showtime=[],this.newPhrase="",this.isCreate=!0},editOther:function(e){this.otherId=e.id,this.newPhrase=e.encourageContent,this.showtime=[moment(e.startTime).format("YYYY-MM-DD HH:mm:ss"),moment(e.endTime).format("YYYY-MM-DD HH:mm:ss")],this.isCreate=!1,this.otherVisible=!0},handleSizeChange:function(e){this.curPageSize=e,this.fetchData()},handleCurrentChange:function(e){this.currentPage=e,this.fetchData()},defaultHandleClose:function(e){e()},otherHandleClose:function(e){e()},mapPagination:function(e){this.currentPage=e.pageNum<1?1:e.pageNum,this.curPageSize=e.pageSize,this.curTotal=e.total},verify:function(){return this.showtime.length<1||new Date(this.selectedDate).getTime()<new Date(this.moment().format("YYYY-MM-DD")).getTime()?(this.$notify.error("请选择当前日期(或以后)为起始的日期区间"),!1):!!this.newPhrase.trim()||(this.$notify.error("请输入激励语"),!1)},fetchDefaultData:function(){var e=this;n({isDefault:1}).then(function(t){e.defaultPhrase=t.data.data.list.length>0?t.data.data.list:[{}]})},fetchData:function(){var e=this;this.isLoading=!0,n({page:this.currentPage,size:this.curPageSize,isDefault:0}).then(function(t){t.data.data.list.forEach(function(t,a){t.createTime=e.moment(t.createTime).format("YYYY-MM-DD HH:mm:ss"),t.status=1==t.status?"进行中":2==t.status?"未到期":3==t.status?"已过期":4==t.status?"已暂停":""}),e.phrases=t.data.data.list,e.mapPagination(t.data.data),e.isLoading=!1}).catch(function(){e.isLoading=!1})}},mounted:function(){var e=this;this.$nextTick(function(){e.fetchData(),e.fetchDefaultData()})}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"homePhrasePage"},[a("div",{staticClass:"title"},[e._v("首页激励语")]),e._v(" "),a("div",{directives:[{name:"permission",rawName:"v-permission",value:"349efd60-f240-4b6e-8677-a440e34a1304",expression:"'349efd60-f240-4b6e-8677-a440e34a1304'"}],staticClass:"defaultPhrase"},[a("sub-title",{attrs:{title:"默认显示"}}),e._v(" "),a("div",{staticClass:"tableBox"},[a("el-table",{directives:[{name:"permission",rawName:"v-permission",value:"86555937-2552-424b-a483-a67c96bd9860",expression:"'86555937-2552-424b-a483-a67c96bd9860'"}],staticStyle:{width:"100%"},attrs:{data:e.defaultPhrase,border:!0}},[a("el-table-column",{attrs:{prop:"encourageContent",label:"激励语"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"46b843dc-e785-4935-8992-8d372a5ae5c9",expression:"'46b843dc-e785-4935-8992-8d372a5ae5c9'"}],attrs:{type:"primary"},on:{click:function(a){e.editDefaultPhraseContent(t.row)}}},[e._v("编辑")])]}}])})],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"编辑",center:"",visible:e.defaultVisible,width:"50%","before-close":e.defaultHandleClose},on:{"update:visible":function(t){e.defaultVisible=t}}},[a("el-input",{attrs:{type:"textarea",placeholder:"输入激励语(30字以内)",maxlength:"30"},model:{value:e.editingDefaultPhraseContent,callback:function(t){e.editingDefaultPhraseContent=t},expression:"editingDefaultPhraseContent"}}),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.defaultVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.editDefault}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.isCreate?"新建":"编辑",center:"",visible:e.otherVisible,width:"40%","before-close":e.otherHandleClose},on:{"update:visible":function(t){e.otherVisible=t}}},[a("div",{staticClass:"dateTimePicker"},[a("div",{staticClass:"subTitle"},[e._v("显示时间")]),e._v(" "),a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd HH:mm:ss","default-time":["00:00:00","23:59:59"]},model:{value:e.showtime,callback:function(t){e.showtime=t},expression:"showtime"}})],1),e._v(" "),a("div",{staticClass:"phraseInput"},[a("div",{staticClass:"subTitle"},[e._v("激励语")]),e._v(" "),a("el-input",{staticStyle:{width:"400px"},attrs:{type:"textarea",placeholder:"输入激励语(30字以内)",maxlength:"30"},model:{value:e.newPhrase,callback:function(t){e.newPhrase=t},expression:"newPhrase"}})],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.otherVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmCreate}},[e._v("确 定")])],1)]),e._v(" "),a("div",{directives:[{name:"permission",rawName:"v-permission",value:"80f77b44-9dc4-47a5-a6da-542878f91ad2",expression:"'80f77b44-9dc4-47a5-a6da-542878f91ad2'"}],staticClass:"otherPhrases"},[a("div",{staticClass:"other_header"},[a("sub-title",{attrs:{title:"指定显示"}}),e._v(" "),a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"f9d1e4a0-2804-4ef2-82bf-93f26de06a5d",expression:"'f9d1e4a0-2804-4ef2-82bf-93f26de06a5d'"}],attrs:{type:"primary"},on:{click:e.createPhrase}},[e._v("新建")])],1),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"},{name:"permission",rawName:"v-permission",value:"722d8ac5-4d61-4a4c-b29b-dc0da9179cc8",expression:"'722d8ac5-4d61-4a4c-b29b-dc0da9179cc8'"}],staticClass:"tableBox"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.phrases,border:!0}},[a("el-table-column",{attrs:{prop:"createTime",label:"创建日期"}}),e._v(" "),a("el-table-column",{attrs:{prop:"time",label:"显示有效期"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e.moment(t.row.startTime).format("YYYY-MM-DD HH:mm:ss")+"至"+e.moment(t.row.endTime).format("YYYY-MM-DD HH:mm:ss"))+"\n          ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"encourageContent",label:"激励语"}}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return["未到期"===t.row.status||"进行中"===t.row.status?a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"1c02794f-28b3-4d64-bb87-cecf1013ed95",expression:"'1c02794f-28b3-4d64-bb87-cecf1013ed95'"}],attrs:{type:"primary",plain:""},on:{click:function(a){e.editOther(t.row)}}},[e._v("编辑")]):e._e(),e._v(" "),"未到期"===t.row.status?a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"80226a04-6d74-4cd5-ba5d-8f927afc72cf",expression:"'80226a04-6d74-4cd5-ba5d-8f927afc72cf'"}],attrs:{type:"danger",plain:""},on:{click:function(a){e.remove(t.row)}}},[e._v("删除")]):e._e()]}}])})],1)],1),e._v(" "),a("div",{directives:[{name:"permission",rawName:"v-permission",value:"722d8ac5-4d61-4a4c-b29b-dc0da9179cc8",expression:"'722d8ac5-4d61-4a4c-b29b-dc0da9179cc8'"}],staticClass:"paginationBox"},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":e.pageSizes,"page-size":e.curPageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.curTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])],1)},staticRenderFns:[]};var d=a("VU/8")(l,c,!1,function(e){a("/S/s")},"data-v-66241248",null);t.default=d.exports},"/S/s":function(e,t){}});
//# sourceMappingURL=54.ad7a47c224e0e7116934.js.map