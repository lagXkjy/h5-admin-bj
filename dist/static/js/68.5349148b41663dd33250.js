webpackJsonp([68],{"8yw3":function(e,t){},igEe:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("0LZo"),l=i("RyKi");function s(e){return l.a.post("admin/Plan/planCycleSave",e)}var c=i("yS1H"),o=i("F+jZ"),n={data:function(){return{actionApi:o.d,isUploading:!1,leastDays:3,cycleList:[],isCreate:!1,cyclenumVisible:!1,dialogVisible:!1,dialog_cycle:0,dialog_tip:"",dialog_id:0,iconUrl:"",trainDay:"",cycles:[],selectedDays:[],weekDays:[{value:1,label:"周一"},{value:2,label:"周二"},{value:3,label:"周三"},{value:4,label:"周四"},{value:5,label:"周五"},{value:6,label:"周六"},{value:0,label:"周日"}]}},watch:{},computed:{selectedValues:function(){var e=this,t=[];return this.selectedDays.forEach(function(i){e.weekDays.forEach(function(e){e.value==i&&t.push(e.label)})}),t.sort()}},components:{SubTitle:a.a},methods:{beforeAvatarUpload:function(e){this.isUploading=!0;var t="image/png"===e.type||"image/jpeg"===e.type,i=e.size/1024/1024<1;return t||(this.$notify.error("上传ICON只能是 JPG/PNG 格式!"),this.isUploading=!1),i||(this.$notify.error("上传ICON大小不能超过 1MB!"),this.isUploading=!1),t&&i},successUpload:function(e,t,i){this.iconUrl=e.data["oss-request-url"],this.isUploading=!1},failedUpload:function(e,t,i){this.$notify.error("文件上传失败, 请重新上传"),this.isUploading=!1},editConfig:function(){this.selectedDays=this.cycles,this.cyclenumVisible=!0},cycleConfig:function(){var e=this;if(this.selectedDays.length<3)return this.$notify.warning("最少选择三天");this.cyclenumVisible=!1,Object(c.b)({confType:"trainDay",confValue:this.selectedDays.join(",")}).then(function(t){if(200==t.data.code)return e.$notify.success("修改配置成功"),void e.fetchConfig();e.$notify.error("修改配置失败")}).catch(function(){e.$notify.error("修改配置失败")})},removeCycle:function(e){var t,i=this;confirm("确认要删除吗")&&(t={id:e.id},l.a.post("admin/Plan/planCycleDelete",t)).then(function(e){200==e.data.code?(i.$notify.success("删除成功"),i.fetchCycles()):i.$notify.error("删除失败")}).catch(function(){i.$notify.error("删除失败")})},resetDialog:function(){this.dialog_cycle=0,this.dialog_tip="",this.isCreate=!1},createCycle:function(){this.isCreate=!0,this.dialog_id=null,this.dialog_cycle="",this.dialog_tip="",this.iconUrl="",this.dialogVisible=!0},editCycle:function(e){this.isCreate=!1,this.iconUrl=e.iconUrl,this.dialog_cycle=e.cycleNum,this.dialog_tip=e.tipText,this.dialog_id=e.id,this.dialogVisible=!0},handleClose:function(e){this.resetDialog(),e()},confirmUpdate:function(){var e=this;this.dialogVisible=!1,this.isCreate?s({tipText:this.dialog_tip,cycleNum:this.dialog_cycle,iconUrl:this.iconUrl}).then(function(t){if(200==t.data.code)return e.$notify.success("创建成功"),void e.fetchCycles();e.$notify.error("创建失败")}).catch(function(){e.$notify.error("创建失败")}):s({id:this.dialog_id,tipText:this.dialog_tip,cycleNum:this.dialog_cycle,iconUrl:this.iconUrl}).then(function(t){if(200==t.data.code)return e.$notify.success("编辑成功"),void e.fetchCycles();e.$notify.error("编辑失败")}).catch(function(){e.$notify.error("编辑失败")})},fetchCycles:function(){var e,t=this;l.a.post("admin/Plan/planCycleList",e).then(function(e){t.cycleList=e.data.data.list})},fetchConfig:function(){var e=this;Object(c.a)({confType:"trainDay"}).then(function(t){e.cycles=t.data.data.confValue.split(",").map(function(e){return Number(e)}),e.trainDay=e.cycles.length})}},mounted:function(){var e=this;this.$nextTick(function(){e.fetchConfig(),e.fetchCycles()})}},r={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"trainingCycle"},[i("div",{staticClass:"cycle"},[i("div",{directives:[{name:"permission",rawName:"v-permission",value:"2a2c5f3c-ec4c-42e2-a910-0aa1480692c0",expression:"'2a2c5f3c-ec4c-42e2-a910-0aa1480692c0'"}],staticClass:"cycle_header"},[i("sub-title",{attrs:{title:"训练周数"}}),e._v(" "),i("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"66894b94-106b-4d38-bd23-94f051c0b92f",expression:"'66894b94-106b-4d38-bd23-94f051c0b92f'"}],attrs:{type:"primary"},on:{click:e.createCycle}},[e._v("新增")])],1),e._v(" "),i("el-dialog",{attrs:{title:e.isCreate?"新增":"编辑",visible:e.dialogVisible,width:"50%",center:"","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("div",{staticClass:"dialog_item"},[i("div",{staticClass:"dialog_subtitle"},[e._v("训练周期")]),e._v(" "),i("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"训练周期"},model:{value:e.dialog_cycle,callback:function(t){e.dialog_cycle=t},expression:"dialog_cycle"}},[i("template",{slot:"append"},[e._v("周")])],2)],1),e._v(" "),i("div",{staticClass:"dialog_item"},[i("div",{staticClass:"dialog_subtitle"},[e._v("提示文案")]),e._v(" "),i("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"提示文案(30字以内)",type:"textarea",maxlength:"30"},model:{value:e.dialog_tip,callback:function(t){e.dialog_tip=t},expression:"dialog_tip"}})],1),e._v(" "),i("div",{staticClass:"dialog_item uploadFile"},[i("div",{staticClass:"dialog_subtitle"},[e._v("ICON")]),e._v(" "),i("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:e.isUploading,expression:"isUploading"}],staticClass:"upload-demo",attrs:{drag:"",action:e.actionApi,"show-file-list":!1,"on-success":e.successUpload,"on-error":e.failedUpload,"before-upload":e.beforeAvatarUpload}},[e.iconUrl?i("img",{staticClass:"avatar",attrs:{src:e.iconUrl}}):i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.confirmUpdate}},[e._v("确 定")])],1)]),e._v(" "),i("el-dialog",{attrs:{title:"设置",visible:e.cyclenumVisible,width:"50%",center:""},on:{"update:visible":function(t){e.cyclenumVisible=t}}},[i("div",{staticClass:"dialog_item"},[i("div",{staticClass:"dialog_subtitle"},[e._v("每周训练日")]),e._v(" "),i("el-checkbox-group",{model:{value:e.selectedDays,callback:function(t){e.selectedDays=t},expression:"selectedDays"}},e._l(e.weekDays,function(t){return i("el-checkbox",{key:t.value,attrs:{label:t.value,border:""}},[e._v(e._s(t.label))])}))],1),e._v(" "),i("div",[e._v("最少运动"+e._s(e.selectedDays.length)+"天;已选:\n          "),e._l(e.selectedValues,function(t,a){return i("span",{key:a},[e._v(e._s(t)+";")])})],2),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.cyclenumVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.cycleConfig}},[e._v("确 定")])],1)]),e._v(" "),i("el-table",{directives:[{name:"permission",rawName:"v-permission",value:"c4dfa1b5-d128-4ada-b0e9-45134cd03713",expression:"'c4dfa1b5-d128-4ada-b0e9-45134cd03713'"}],staticStyle:{width:"100%"},attrs:{data:e.cycleList}},[i("el-table-column",{attrs:{label:"ID",prop:"id"}}),e._v(" "),i("el-table-column",{attrs:{label:"周数选择",prop:"cycleNum"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.cycleNum)+"周\n        ")]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"提示文案",prop:"tipText"}}),e._v(" "),i("el-table-column",{attrs:{label:"ICON",prop:"iconUrl"},scopedSlots:e._u([{key:"default",fn:function(e){return[i("img",{staticStyle:{"max-width":"100px"},attrs:{src:e.row.iconUrl,alt:""}})]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作",prop:"time",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"77767639-9c70-46bb-b22a-178a5d449518",expression:"'77767639-9c70-46bb-b22a-178a5d449518'"}],attrs:{type:"primary",plain:""},on:{click:function(i){e.editCycle(t.row)}}},[e._v("编辑")]),e._v(" "),i("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"93f4662c-a409-4182-ac16-9ff495d35792",expression:"'93f4662c-a409-4182-ac16-9ff495d35792'"}],attrs:{type:"danger",plain:""},on:{click:function(i){e.removeCycle(t.row)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),i("div",{directives:[{name:"permission",rawName:"v-permission",value:"bb98f2d0-26c2-49e1-909c-a145186b3f86",expression:"'bb98f2d0-26c2-49e1-909c-a145186b3f86'"}],staticClass:"cycle_days"},[i("sub-title",{attrs:{title:"每周训练日数"}}),e._v(" "),i("div",{staticClass:"least_days"},[e._v("每周训练日: 最少"+e._s(e.trainDay)+"天\n      "),i("a",{directives:[{name:"permission",rawName:"v-permission",value:"e3021ead-8b2c-4b19-991b-52ae14f77eda",expression:"'e3021ead-8b2c-4b19-991b-52ae14f77eda'"}],staticClass:"hyperlink",on:{click:e.editConfig}},[e._v("设置")])])],1)])},staticRenderFns:[]};var d=i("VU/8")(n,r,!1,function(e){i("8yw3")},"data-v-0009149c",null);t.default=d.exports}});
//# sourceMappingURL=68.5349148b41663dd33250.js.map