{"version":3,"sources":["webpack:///./src/api/operation/music.js","webpack:///src/pages/operation/music/components/MusicTable.vue","webpack:///./src/pages/operation/music/components/MusicTable.vue?8f64","webpack:///./src/pages/operation/music/components/MusicTable.vue","webpack:///src/pages/operation/music/Page.vue","webpack:///./src/pages/operation/music/Page.vue?2f38","webpack:///./src/pages/operation/music/Page.vue"],"names":["getMusicList","params","axiosClient","post","MusicTable","Array","tableData","list","_this","this","id","then","res","_this2","row","clearSelection","val","components_MusicTable","render","_vm","_h","$createElement","_c","_self","ref","staticStyle","width","attrs","data","datas","tooltip-effect","on","selection-change","handleSelectionChange","label","prop","_v","scopedSlots","_u","key","fn","scope","_s","musicLength","directives","name","rawName","value","expression","type","plain","click","$event","remove","staticRenderFns","music_components_MusicTable","__webpack_require__","normalizeComponent","ssrContext","Page","common","dropdownStoreList","fetchNormal","isLt20M","size","pop","suffix","musicList","store","url","curMusicType","param","success","fetchMusic","error","message","catch","pageNum","pageSize","total","musicType","currentNormalPage","currentNormalSize","_this3","fetchCrazy","_this4","music_Page","staticClass","title","visible","dialogVisible","update:visible","font-size","color","margin-bottom","placeholder","model","callback","$$v","_l","item","index","storeName","action","actionApi","on-success","successUpload","on-error","failedUpload","before-upload","beforeAvatarUpload","file-list","fileList","slot","cancel","confirm","_uploadMusic","normalMusic","refresh","current-page","page-sizes","page-size","layout","curNormalTotal","size-change","handleSizeChange","current-change","handleCurrentChange","crazyMusic","Page_Component","Page_normalizeComponent","__webpack_exports__"],"mappings":"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","file":"static/js/32.ecf8461548146c1ed15c.js","sourcesContent":["import {\n  axiosClient\n} from 'common/axiosClient';\n\n// 获取音乐列表\nfunction getMusicList(params) {\n  return axiosClient.post('admin/Main/musicList', params);\n}\n\n// 音频上传\nfunction uploadMusic(params) {\n  return axiosClient.post('admin/Main/uploadBatch', params);\n}\n\n// 删除音频\nexport function removeMusic(params) {\n  return axiosClient.post('admin/Main/musicDelete', params);\n}\nexport {\n  getMusicList,\n  uploadMusic\n}\n\n\n// WEBPACK FOOTER //\n// ./src/api/operation/music.js","<template>\n  <el-table ref=\"multipleTable\" :data=\"datas\" tooltip-effect=\"dark\" style=\"width: 100%\" @selection-change=\"handleSelectionChange\">\n    <!-- <el-table-column type=\"selection\">\n    </el-table-column> -->\n    <el-table-column label=\"ID\" prop=\"id\">\n    </el-table-column>\n    <el-table-column prop=\"createTime\" label=\"上传时间\">\n    </el-table-column>\n    <el-table-column prop=\"musicName\" label=\"名称\">\n    </el-table-column>\n    <el-table-column prop=\"musicUrl\" label=\"输出地址\">\n    </el-table-column>\n    <el-table-column prop=\"musicLength\" label=\"大小\">\n      <template slot-scope=\"scope\">\n        {{scope.row.musicLength}}MB\n      </template>\n    </el-table-column>\n     <el-table-column label=\"操作\">\n       <template slot-scope=\"scope\">\n         <el-button type=\"danger\" plain @click=\"remove(scope.row)\" v-permission=\"'1c61cc40-de8e-4e0b-8541-3c237f9139f9'\">删除</el-button>\n       </template>\n    </el-table-column>\n  </el-table>\n</template>\n\n<script>\nimport { deepCopy } from 'common/utils';\n\n// import moment from 'moment';\n\nimport { removeMusic } from 'api/operation/music';\n\nexport default {\n  props: {\n    tableData: {\n      type: Array,\n      default: () => []\n    }\n  },  \n  data() {\n    return {\n      multipleSelection: []\n    };\n  },\n  computed: {\n    datas() {\n      let list = deepCopy(this.tableData);\n      list.forEach( (item, index) => {\n        item.createTime = moment(item.createTime).format('YYYY-MM-DD HH:mm:ss');\n      })\n      return list;\n    }\n  },\n  methods: {\n    remove(row) {\n      if (confirm('确定要删除吗?')) {\n        removeMusic({\n          id: row.id\n        }).then( (res) => {\n          if (res.data.code == 200) {\n            this.$notify.success('删除成功')\n            this.$emit('refresh')\n          } else {\n            this.$notify.error('删除失败')\n          }\n        }).catch( () => {\n          this.$notify.error('删除失败')\n        })\n      }\n    },\n    toggleSelection(rows) {\n      if (rows) {\n        rows.forEach(row => {\n          this.$refs.multipleTable.toggleRowSelection(row);\n        });\n      } else {\n        this.$refs.multipleTable.clearSelection();\n      }\n    },\n    handleSelectionChange(val) {\n      this.multipleSelection = val;\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/pages/operation/music/components/MusicTable.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-table',{ref:\"multipleTable\",staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.datas,\"tooltip-effect\":\"dark\"},on:{\"selection-change\":_vm.handleSelectionChange}},[_c('el-table-column',{attrs:{\"label\":\"ID\",\"prop\":\"id\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"createTime\",\"label\":\"上传时间\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"musicName\",\"label\":\"名称\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"musicUrl\",\"label\":\"输出地址\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"musicLength\",\"label\":\"大小\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(\"\\n      \"+_vm._s(scope.row.musicLength)+\"MB\\n    \")]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"操作\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-button',{directives:[{name:\"permission\",rawName:\"v-permission\",value:('1c61cc40-de8e-4e0b-8541-3c237f9139f9'),expression:\"'1c61cc40-de8e-4e0b-8541-3c237f9139f9'\"}],attrs:{\"type\":\"danger\",\"plain\":\"\"},on:{\"click\":function($event){_vm.remove(scope.row)}}},[_vm._v(\"删除\")])]}}])})],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-525a5e5b\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/operation/music/components/MusicTable.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-525a5e5b\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./MusicTable.vue\")\n}\nvar normalizeComponent = require(\"!../../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./MusicTable.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./MusicTable.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-525a5e5b\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./MusicTable.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-525a5e5b\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/operation/music/components/MusicTable.vue\n// module id = null\n// module chunks = ","<template>\n  <div class=\"protalPage\">\n    <div class=\"usersPage\">\n      <div class=\"title\">\n        音乐管理\n      </div>\n      <el-dialog title=\"上传音频\" :visible.sync=\"dialogVisible\" width=\"40%\">\n        <div style=\"font-size:10px;color:red\">(出现<span style=\"color:green\">绿色对号<i class=\"el-icon-circle-check\"></i></span>标识时为上传成功!)</div>\n        <div class=\"dialog_item\">\n          <div style=\"width: 80px;\">选择门店</div>\n          <el-select v-model=\"store\" placeholder=\"请选择\" size=\"medium\" style=\"margin-bottom: 10px\">\n            <el-option v-for=\"(item, index) in dropdownStoreList\" :key=\"index\" :label=\"item.storeName\" :value=\"item.id\">\n            </el-option>\n          </el-select>\n        </div>\n        <el-upload class=\"upload-demo\" :action=\"actionApi\" :on-success=\"successUpload\" :on-error=\"failedUpload\" :before-upload=\"beforeAvatarUpload\" :file-list=\"fileList\">\n          <el-button size=\"small\" type=\"primary\">点击上传</el-button> \n        </el-upload>\n        <span slot=\"footer\" class=\"dialog-footer\">\n          <el-button @click=\"cancel\">取 消</el-button>\n          <el-button type=\"primary\" @click=\"confirm\">确 定</el-button>\n        </span>\n      </el-dialog>\n      <div class=\"music\" v-permission=\"'fb727079-cd44-48a1-a861-6b246b6a8a88'\">\n        <div class=\"header\">\n          <div class=\"subtitle\">普通音频</div>\n          <el-button type=\"primary\" @click=\"_uploadMusic(1)\" v-permission=\"'4d4e6ced-3d23-4a20-b8db-1cd1fe0f4ade'\">上传</el-button>\n        </div>\n        <div class=\"musicTable\" v-permission=\"'47f086fa-3673-472a-84c3-ac8da8988653'\">\n          <music-table :tableData=\"normalMusic\" @refresh=\"fetchMusic\"></music-table>\n          <div class=\"paginationBox\">\n            <el-pagination @size-change=\"handleSizeChange\" @current-change=\"handleCurrentChange\" :current-page=\"currentNormalPage\" :page-sizes=\"[10, 20, 30, 40]\" :page-size=\"currentNormalSize\" layout=\"total, sizes, prev, pager, next, jumper\" :total=\"curNormalTotal\">\n            </el-pagination>\n          </div>\n        </div>\n      </div>\n      <div class=\"specialMusic\" v-permission=\"'0e5c45e1-72be-4203-83cf-1be188cf5906'\">\n        <div class=\"header\">\n          <div class=\"subtitle\">紧急音频</div>\n          <el-button type=\"primary\" @click=\"_uploadMusic(2)\" v-permission=\"'6bd38c83-6ea9-4683-8404-af26f0f3cddc'\">上传</el-button>\n        </div>\n        <div class=\"speMusicTable\">\n          <music-table :tableData=\"crazyMusic\" v-permission=\"'98a4d706-711d-412d-955a-041bca167f80'\" @refresh=\"fetchMusic\"></music-table>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport MusicTable from './components/MusicTable';\n\nimport * as MusicApi from 'api/operation/music';\n\nimport { uploadFileApi } from 'common/common';\n\nexport default {\n  components: {\n    MusicTable\n  },\n  data() {\n    return {\n      store: 1,\n      currentNormalPage: 1,\n      currentNormalSize: 10,\n      curNormalTotal: 0,\n      actionApi: uploadFileApi,\n      fileList: [],\n      musicList: [],\n      musicUrl: '',\n      musicName: '',\n      normalMusic: [],\n      crazyMusic: [],\n      curMusicType: 1,\n      dialogVisible: false,\n      isOverUploading: false,\n      useableMusicSuffix: [\n        'mp3',\n        'wma',\n        'mod',\n        'wmv',\n        'ra',\n        'cd',\n        'md',\n        'asf',\n        'mp3pro'\n      ] // 音乐格式\n    };\n  },\n  computed: {\n    dropdownStoreList() {\n      return this.$store.state.board.dropdownStoreList\n    },\n  },\n  methods: {\n    handleSizeChange(val) {\n      this.currentNormalSize = val;\n      this.fetchNormal();\n    },\n    handleCurrentChange(val) {\n      this.currentNormalPage = val;\n      this.fetchNormal();\n    },\n    handleRemove(file, fileList) {\n      // console.log(file, fileList);\n    },\n    handlePreview(file) {\n      // console.log(file);\n    },\n    handleExceed(files, fileList) {},\n    beforeRemove(file, fileList) {},\n    beforeAvatarUpload(file) {\n      const isMP4 = file.type === 'audio/mp3' || file.type === 'audio/mpeg';\n      // const isMP4 = true;\n      const isLt20M = file.size / 1024 / 1024 < 20;\n      if (!isMP4) {\n        this.$notify.error('上传音频只能是 MP3 格式!');\n      }\n      if (!isLt20M) {\n        this.$notify.error('上传视音频大小不能超过 20MB!');\n      }\n      return isMP4 && isLt20M;\n    },\n    successUpload(response, file, filelist) {\n      let ossmusicUrl = response.data['oss-request-url'];\n      let size = (response.data.info.size_upload / 1024 / 1024).toFixed(1);\n      this.musicList.push({ name: file.name, url: ossmusicUrl, size: size });\n      this.isOverUploading = true;\n    },\n    failedUpload(err, file, filelist) {\n      this.$notify.error('文件上传失败, 请重新上传');\n      this.isOverUploading = false;\n    },\n    getSuffix(musicName) {\n      if (!musicName || typeof musicName !== 'string') return '';\n      let arr = musicName.split('.');\n      let suffix  = arr.pop();\n      let name = arr.join('');\n      return {\n        name: name,\n        suffix: suffix\n      }\n    },\n    confirm() {\n      if (!this.isOverUploading) {\n        return this.$notify.warning('请等待文件上传成功');\n      }\n      let list = JSON.parse(JSON.stringify(this.musicList));\n      let params = [];\n\n      list.forEach( (item) => {\n        let param = {};\n        param.storeId = this.store;\n        param.musicName =this.getSuffix(item.name).name;\n        param.musicSuffix = this.getSuffix(item.name).suffix;\n        param.musicUrl = item.url;\n        param.musicLength = item.size;\n        param.musicType = this.curMusicType\n        params.push(param);\n      })\n      this.dialogVisible = false;\n      MusicApi.uploadMusic({\n        param: JSON.stringify(params)\n      })\n        .then(res => {\n          // console.log(res);\n          if (res.data.code == 200) {\n            this.$notify.success(`音频上传成功`);\n            this.fetchMusic();\n          } else {\n            this.$notify.error(\n              `音频上传失败, 错误描述: ${res.data.message}`\n            );\n          }\n        })\n        .catch(error => {\n          this.$notify.error(\n            `音频上传失败, 错误描述: 网络异常`\n          );\n        });\n    },\n    mapNormalPagination(res) {\n      this.currentNormalPage = res.pageNum < 1 ? 1 : res.pageNum;\n      this.currentNormalSize = res.pageSize;\n      this.curNormalTotal = res.total;\n    },\n    cancel() {\n      this.dialogVisible = false;\n    },\n    _uploadMusic(musicType) {\n      this.curMusicType = musicType;\n      this.fileList = [];\n      this.musicList = [];\n      this.dialogVisible = true;\n    },\n    fetchNormal() {\n      MusicApi.getMusicList({\n        // 获取普通音频\n        page: this.currentNormalPage,\n        size: this.currentNormalSize,\n        musicType: 1\n      }).then(res => {\n        // console.log('普通音频', res);\n        this.normalMusic = res.data.data.list;\n        this.mapNormalPagination(res.data.data);\n      });\n    },\n    fetchCrazy() {\n      MusicApi.getMusicList({\n        // 获取紧急音频\n        page: 1,\n        size: 100,\n        musicType: 2\n      }).then(res => {\n        // console.log('紧急音频', res);\n        this.crazyMusic = res.data.data.list;\n      });\n    },\n    fetchMusic() {\n      this.fetchNormal();\n      this.fetchCrazy();\n    }\n  },\n  beforeRouteEnter(to, from, next) {\n    next(vm => {\n      vm.$nextTick(() => {\n        vm.fetchMusic();\n      });\n    });\n  },\n  mounted() {\n    this.$nextTick(() => {\n      this.musicList = [];\n      this.fetchMusic();\n      if (this.dropdownStoreList.length==0) {\n        this.$store.dispatch('getStores');\n      }\n    });\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import '~assets/style/utils';\n\n.usersPage {\n  background-color: #ffffff;\n  width: 100%;\n  height: 100%;\n  box-sizing: border-box;\n  padding: 20px;\n  .title {\n    font-size: 30px;\n    height: 50px;\n    line-height: 50px;\n    border: {\n      bottom: 1px solid #0e0808;\n    }\n\n  }\n  .header {\n    @include flexbox;\n    @include justify-content(space-between);\n  }\n  .subtitle {\n    font-size: 20px;\n    font-weight: 600;\n  }\n  .header {\n    box-sizing: border-box;\n    padding: {\n      top: 30px;\n      bottom: 30px;\n    }\n  }\n  .paginationBox {\n    padding: {\n      top: 20px;\n    }\n  }\n  .specialMusic {\n    width: 100%;\n    height: 400px;\n  }\n\n  .dialog_item {\n    @include flexbox;\n    @include align-items(center);\n  }\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/pages/operation/music/Page.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"protalPage\"},[_c('div',{staticClass:\"usersPage\"},[_c('div',{staticClass:\"title\"},[_vm._v(\"\\n      音乐管理\\n    \")]),_vm._v(\" \"),_c('el-dialog',{attrs:{\"title\":\"上传音频\",\"visible\":_vm.dialogVisible,\"width\":\"40%\"},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('div',{staticStyle:{\"font-size\":\"10px\",\"color\":\"red\"}},[_vm._v(\"(出现\"),_c('span',{staticStyle:{\"color\":\"green\"}},[_vm._v(\"绿色对号\"),_c('i',{staticClass:\"el-icon-circle-check\"})]),_vm._v(\"标识时为上传成功!)\")]),_vm._v(\" \"),_c('div',{staticClass:\"dialog_item\"},[_c('div',{staticStyle:{\"width\":\"80px\"}},[_vm._v(\"选择门店\")]),_vm._v(\" \"),_c('el-select',{staticStyle:{\"margin-bottom\":\"10px\"},attrs:{\"placeholder\":\"请选择\",\"size\":\"medium\"},model:{value:(_vm.store),callback:function ($$v) {_vm.store=$$v},expression:\"store\"}},_vm._l((_vm.dropdownStoreList),function(item,index){return _c('el-option',{key:index,attrs:{\"label\":item.storeName,\"value\":item.id}})}))],1),_vm._v(\" \"),_c('el-upload',{staticClass:\"upload-demo\",attrs:{\"action\":_vm.actionApi,\"on-success\":_vm.successUpload,\"on-error\":_vm.failedUpload,\"before-upload\":_vm.beforeAvatarUpload,\"file-list\":_vm.fileList}},[_c('el-button',{attrs:{\"size\":\"small\",\"type\":\"primary\"}},[_vm._v(\"点击上传\")])],1),_vm._v(\" \"),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":_vm.cancel}},[_vm._v(\"取 消\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.confirm}},[_vm._v(\"确 定\")])],1)],1),_vm._v(\" \"),_c('div',{directives:[{name:\"permission\",rawName:\"v-permission\",value:('fb727079-cd44-48a1-a861-6b246b6a8a88'),expression:\"'fb727079-cd44-48a1-a861-6b246b6a8a88'\"}],staticClass:\"music\"},[_c('div',{staticClass:\"header\"},[_c('div',{staticClass:\"subtitle\"},[_vm._v(\"普通音频\")]),_vm._v(\" \"),_c('el-button',{directives:[{name:\"permission\",rawName:\"v-permission\",value:('4d4e6ced-3d23-4a20-b8db-1cd1fe0f4ade'),expression:\"'4d4e6ced-3d23-4a20-b8db-1cd1fe0f4ade'\"}],attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm._uploadMusic(1)}}},[_vm._v(\"上传\")])],1),_vm._v(\" \"),_c('div',{directives:[{name:\"permission\",rawName:\"v-permission\",value:('47f086fa-3673-472a-84c3-ac8da8988653'),expression:\"'47f086fa-3673-472a-84c3-ac8da8988653'\"}],staticClass:\"musicTable\"},[_c('music-table',{attrs:{\"tableData\":_vm.normalMusic},on:{\"refresh\":_vm.fetchMusic}}),_vm._v(\" \"),_c('div',{staticClass:\"paginationBox\"},[_c('el-pagination',{attrs:{\"current-page\":_vm.currentNormalPage,\"page-sizes\":[10, 20, 30, 40],\"page-size\":_vm.currentNormalSize,\"layout\":\"total, sizes, prev, pager, next, jumper\",\"total\":_vm.curNormalTotal},on:{\"size-change\":_vm.handleSizeChange,\"current-change\":_vm.handleCurrentChange}})],1)],1)]),_vm._v(\" \"),_c('div',{directives:[{name:\"permission\",rawName:\"v-permission\",value:('0e5c45e1-72be-4203-83cf-1be188cf5906'),expression:\"'0e5c45e1-72be-4203-83cf-1be188cf5906'\"}],staticClass:\"specialMusic\"},[_c('div',{staticClass:\"header\"},[_c('div',{staticClass:\"subtitle\"},[_vm._v(\"紧急音频\")]),_vm._v(\" \"),_c('el-button',{directives:[{name:\"permission\",rawName:\"v-permission\",value:('6bd38c83-6ea9-4683-8404-af26f0f3cddc'),expression:\"'6bd38c83-6ea9-4683-8404-af26f0f3cddc'\"}],attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm._uploadMusic(2)}}},[_vm._v(\"上传\")])],1),_vm._v(\" \"),_c('div',{staticClass:\"speMusicTable\"},[_c('music-table',{directives:[{name:\"permission\",rawName:\"v-permission\",value:('98a4d706-711d-412d-955a-041bca167f80'),expression:\"'98a4d706-711d-412d-955a-041bca167f80'\"}],attrs:{\"tableData\":_vm.crazyMusic},on:{\"refresh\":_vm.fetchMusic}})],1)])],1)])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-99b414a2\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/operation/music/Page.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-99b414a2\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Page.vue\")\n}\nvar normalizeComponent = require(\"!../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Page.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Page.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-99b414a2\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./Page.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-99b414a2\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/operation/music/Page.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}