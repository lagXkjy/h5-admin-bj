webpackJsonp([47],{KOEC:function(i,e){},Rs9B:function(i,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=t("0LZo"),s=t("RyKi");function l(i){return s.a.post("admin/Plan/planMedicalHisSave",i)}var n=t("Y2va"),c=t("VTbc"),o=t("yS1H"),r={data:function(){return{levelId:"",dialog_level:"",diseases:[],levels:[],id:"",isCreate:!1,levelVisible:!1,dialogVisible:!1,diseaseName:"",checkedFacility:[],facilityes_a:[],facilityes_b:[],dialog_facility:[]}},components:{SubTitle:a.a},computed:{trainingLevel:function(){var i=this;if(this.levelId&&0!=this.levels.length){var e=this.levels.find(function(e){return e.id==i.levelId});return e?(this.configDialog=!1,e.strengthLv):(this.configDialog=!0,"")}return this.configDialog=!0,""}},watch:{dialog_facility_a:function(i){}},methods:{editDisease:function(i){this.dialog_facility=i.facilityTypeConfList.map(function(i){return i.facilityType}),this.checkedFacility=i.facilityTypeConfList.map(function(i){return i.facilityType}),this.diseaseName=i.name,this.id=i.id,this.isCreate=!1,this.dialogVisible=!0},confirmUpdate:function(){var i=this;!this.dialog_facility||this.dialog_facility.length<1?this.$notify.warning("请选择对应的器械"):(this.dialogVisible=!1,this.checkedFacility=this.dialog_facility,this.isCreate?l({name:this.diseaseName,facilityTypeList:this.checkedFacility.join(",")}).then(function(e){if(200==e.data.code)return i.$notify.success("新建伤痛病史成功"),void i.fetchDisease();i.$notify.error("新建伤痛病史失败")}).catch(function(){i.$notify.error("新建伤痛病史失败")}):l({id:this.id,name:this.diseaseName,facilityTypeList:this.checkedFacility.join(",")}).then(function(e){if(200==e.data.code)return i.$notify.success("编辑伤痛病史成功"),void i.fetchDisease();i.$notify.error("编辑伤痛病史失败")}).catch(function(){i.$notify.error("编辑伤痛病史失败")}))},createDisease:function(){this.isCreate=!0,this.diseaseName="",this.dialog_facility=[],this.id="",this.dialogVisible=!0},fetchDisease:function(){var i,e=this;(i={page:1,size:100},s.a.post("admin/Plan/planMedicalHisList",i)).then(function(i){i.data.data.list.forEach(function(i,e){i.facilities=[],i.facilityTypeConfList.forEach(function(e,t){i.facilities.push(e.facilityName)}),i.facilities=i.facilities.join(";")}),e.diseases=i.data.data.list})},remove:function(i){var e,t=this;confirm("确认删除吗?")&&(e={id:i.id},s.a.post("admin/Plan/planMedicalHisDelete",e)).then(function(i){if(200==i.data.code)return t.$notify.success("删除伤痛病史成功"),void t.fetchDisease();t.$notify.error("删除伤痛病史失败")}).catch(function(){t.$notify.error("删除伤痛病史失败")})},handleClose:function(i){i()},level_setting:function(){this.levelVisible=!0},confirmConfig:function(){var i=this;this.levelVisible=!1,Object(o.b)({confType:"medicalHis",confValue:this.dialog_level}).then(function(e){if(200==e.data.code)return i.$notify.success("修改配置成功"),i.levelId=i.dialog_level,void i.fetchConfig();i.$notify.error("修改配置失败")}).catch(function(){i.$notify.error("修改配置失败")})},fetchLevel:function(){var i=this;Object(c.a)().then(function(e){i.levels=e.data.data.list})},fetchConfig:function(){var i=this;Object(o.a)({confType:"medicalHis"}).then(function(e){i.levelId=e.data.data.confValue,i.dialog_level=parseInt(e.data.data.confValue)})},fetchSportFacility_a:function(){var i=this;Object(n.b)({facilityKind:1}).then(function(e){e.data.data.forEach(function(i,e){var t=void 0,a=void 0;if(i.mainBodyList){var s=[];i.mainBodyList.forEach(function(i,e){s.push(i.name)}),t=s.join("、")}else t="";if(i.minorBodyList){var l=[];i.minorBodyList.forEach(function(i,e){l.push(i.name)}),a=l.join("、")}else a="";i.parts={mainParts:t,minorParts:a}}),i.facilityes_a=e.data.data})},fetchSportFacility_b:function(){var i=this;Object(n.b)({facilityKind:2}).then(function(e){e.data.data.forEach(function(i,e){var t=void 0,a=void 0;if(i.mainBodyList){var s=[];i.mainBodyList.forEach(function(i,e){s.push(i.name)}),t=s.join("、")}else t="";if(i.minorBodyList){var l=[];i.minorBodyList.forEach(function(i,e){l.push(i.name)}),a=l.join("、")}else a="";i.parts={mainParts:t,minorParts:a}}),i.facilityes_b=e.data.data})}},beforeRouteEnter:function(i,e,t){t(function(i){i.$nextTick(function(){i.fetchDisease()})})},mounted:function(){var i=this;this.$nextTick(function(){i.fetchLevel(),i.fetchConfig(),i.fetchSportFacility_a(),i.fetchSportFacility_b(),i.fetchDisease()})}},d={render:function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{staticClass:"diseaseConfig"},[t("div",{staticClass:"disease_to_level"},[i._v("\n    病痛对应设备的训练难度:"+i._s(i.trainingLevel)+"\n    "),t("a",{directives:[{name:"permission",rawName:"v-permission",value:"430d0bc4-3ee0-455c-9778-3492d3ac0a71",expression:"'430d0bc4-3ee0-455c-9778-3492d3ac0a71'"}],staticClass:"hyperlink",on:{click:i.level_setting}},[i._v("设置")])]),i._v(" "),t("div",{staticClass:"diseaseList_header"},[t("sub-title",{attrs:{title:"病痛列表"}}),i._v(" "),t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"b8fb5ecd-0c10-40d8-9e4e-23e71afd85a1",expression:"'b8fb5ecd-0c10-40d8-9e4e-23e71afd85a1'"}],attrs:{type:"primary"},on:{click:i.createDisease}},[i._v("新增")])],1),i._v(" "),t("el-dialog",{attrs:{title:"设置",visible:i.levelVisible,width:"50%",center:""},on:{"update:visible":function(e){i.levelVisible=e}}},[t("div",{staticClass:"dialog_item"},[t("div",{staticClass:"dialog_subtitle"},[i._v("病痛对应设备的训练难度(单选)")]),i._v(" "),t("el-radio-group",{model:{value:i.dialog_level,callback:function(e){i.dialog_level=e},expression:"dialog_level"}},i._l(i.levels,function(e,a){return t("el-radio",{key:a,attrs:{label:e.id}},[i._v(i._s(e.strengthLv))])}))],1),i._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(e){i.levelVisible=!1}}},[i._v("取 消")]),i._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:i.confirmConfig}},[i._v("确 定")])],1)]),i._v(" "),t("el-dialog",{attrs:{title:i.isCreate?"新增":"编辑",visible:i.dialogVisible,width:"50%",center:"","before-close":i.handleClose},on:{"update:visible":function(e){i.dialogVisible=e}}},[t("div",{staticClass:"dialog_item"},[t("div",{staticClass:"dialog_subtitle"},[i._v("病痛名称")]),i._v(" "),t("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"病痛名称(6字以内)",maxlength:"6"},model:{value:i.diseaseName,callback:function(e){i.diseaseName=e},expression:"diseaseName"}})],1),i._v(" "),t("div",{staticClass:"dialog_item"},[t("div",{staticClass:"dialog_subtitle"},[i._v("对应设备")]),i._v(" "),t("div",{staticClass:"facilitiesBox"},[t("div",{staticClass:"facility_a"},[i._v("无氧运动设备")]),i._v(" "),t("div",{staticClass:"facility_checkbox"},[t("el-checkbox-group",{model:{value:i.dialog_facility,callback:function(e){i.dialog_facility=e},expression:"dialog_facility"}},i._l(i.facilityes_a,function(e){return t("el-checkbox",{key:e.id,attrs:{label:e.facilityType,border:""}},[i._v(i._s(e.facilityName))])}))],1),i._v(" "),t("div",{staticClass:"facility_b"},[i._v("有氧运动设备")]),i._v(" "),t("div",{staticClass:"facility_checkbox"},[t("el-checkbox-group",{model:{value:i.dialog_facility,callback:function(e){i.dialog_facility=e},expression:"dialog_facility"}},i._l(i.facilityes_b,function(e){return t("el-checkbox",{key:e.id,attrs:{label:e.facilityType,border:""}},[i._v(i._s(e.facilityName)+"\n              "),t("span",[i._v("(主:"+i._s(e.parts.mainParts)+";辅:"+i._s(e.parts.minorParts)+")")])])}))],1)])]),i._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(e){i.dialogVisible=!1}}},[i._v("取 消")]),i._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:i.confirmUpdate}},[i._v("确 定")])],1)]),i._v(" "),t("div",{directives:[{name:"permission",rawName:"v-permission",value:"53d8095a-2c8d-4b4f-8b2b-54ea3494f6f8",expression:"'53d8095a-2c8d-4b4f-8b2b-54ea3494f6f8'"}],staticClass:"diseaseTable"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:i.diseases}},[t("el-table-column",{attrs:{label:"序号",prop:"id"}}),i._v(" "),t("el-table-column",{attrs:{label:"疾病",prop:"name"}}),i._v(" "),t("el-table-column",{attrs:{label:"对应器械",prop:"facilities"}}),i._v(" "),t("el-table-column",{attrs:{label:"操作",prop:"time",width:"300"},scopedSlots:i._u([{key:"default",fn:function(e){return[t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"9fb6e43c-3f57-4a72-89df-4553c1d6ac4a",expression:"'9fb6e43c-3f57-4a72-89df-4553c1d6ac4a'"}],attrs:{type:"primary",plain:""},on:{click:function(t){i.editDisease(e.row)}}},[i._v("编辑")]),i._v(" "),t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"9868dce1-8cff-4be0-b486-a6081cfba91d",expression:"'9868dce1-8cff-4be0-b486-a6081cfba91d'"}],attrs:{type:"danger",plain:""},on:{click:function(t){i.remove(e.row)}}},[i._v("删除")])]}}])})],1)],1)],1)},staticRenderFns:[]};var f=t("VU/8")(r,d,!1,function(i){t("KOEC")},"data-v-cd4de530",null);e.default=f.exports}});
//# sourceMappingURL=47.e38070745767fc177a3e.js.map