webpackJsonp([33],{"5EgQ":function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=t("Dd8w"),o=t.n(a),l=t("NYxO"),s=t("JaHG"),n={props:{tableData:{type:Array,default:function(){return[]}}},data:function(){return{dialogVisible:!1,dialogVisible_remove:!1,editingPublicDevice:{},fileList2:[],uploadImgUrl:"",isLoadingImgSuccess:!1}},methods:o()({},Object(l.b)(["storeConfigUploadImg","updateStoreConfigPublicDevice","getStoreConfigPublicDevice"]),{handleRemove:function(e,i){},submitUpload:function(){this.$refs.upload.submit()},handlePreview:function(e){},beforeUploadImg:function(e){var i="image/jpeg"===e.type||"image/png"===e.type,t=e.size/1024/1024<1;return i||this.$notify.error("上传图片只能是 JPG或PNG 格式!"),t||this.$notify.error("上传图片大小不能超过 1MB!"),i&&t},upLoadImg:function(e){this.$notify.warning("图片正在上传, 请耐心等待");var i=this,t="",a=new FileReader;a.readAsDataURL(e.file),a.onloadend=function(){t=this.result;var a=e.file.name.split("."),o=a[a.length-1];i.storeConfigUploadImg({imageBase64:t,type:o}).then(function(e){i.uploadImgUrl=e,i.isLoadingImgSuccess=!0,i.$notify.success("图片加载成功")}).catch(function(e){i.$notify.error("图片加载失败, 请重试"),i.isLoadingImgSuccess=!1})}},showDialog:function(e){this.editingPublicDevice=Object(s.b)(e),this.uploadImgUrl=Object(s.b)(e).facilityIconUrl,this.dialogVisible=!0},showDialog2:function(e){this.editingPublicDevice=Object(s.b)(e),this.dialogVisible_remove=!0},handleClose:function(e){this.editingPublicDevice={},e()},confirm:function(e){var i=this;this.updateStoreConfigPublicDevice({id:e.id,name:e.facilityName,imageUrl:this.uploadImgUrl,typeStr:e.facilityType}).then(function(){i.$notify.success("公共设备["+e.id+"]更新成功"),i.dialogVisible=!1,i.getStoreConfigPublicDevice()}).catch(function(){i.$notify.error("公共设备["+e.id+"]更新失败, 请重试"),i.dialogVisible=!1})},confirm2:function(e){this.$notify.error("无此接口"),this.dialogVisible_remove=!1}})},c={render:function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("div",{staticClass:"tablePage"},[t("el-dialog",{attrs:{title:"编辑",visible:e.dialogVisible,width:"30%","before-close":e.handleClose},on:{"update:visible":function(i){e.dialogVisible=i}}},[t("div",{staticClass:"subTitle"},[t("div",{staticClass:"subsubTitle"},[e._v("名称:")]),e._v(" "),t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"输入设备ID",clearable:""},model:{value:e.editingPublicDevice.facilityName,callback:function(i){e.$set(e.editingPublicDevice,"facilityName",i)},expression:"editingPublicDevice.facilityName"}})],1),e._v(" "),t("div",{staticClass:"uploadBox"},[t("el-upload",{ref:"upload",staticClass:"avatar-uploader",attrs:{action:"http://api-control.test.hxsapp.com/admin/Upload/uploadBase64","on-preview":e.handlePreview,"on-remove":e.handleRemove,"list-type":"picture-card","auto-upload":!0,"http-request":e.upLoadImg,"show-file-list":!1,"before-upload":e.beforeUploadImg}},[e.uploadImgUrl?t("img",{staticClass:"avatar",attrs:{src:e.uploadImgUrl}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon imgborder"})]),e._v(" "),t("div",{staticClass:"uploadTips"},[t("div",[e._v("尺寸: 40X40")]),e._v(" "),t("div",[e._v("支持JPG/PNG格式")]),e._v(" "),t("div",[e._v("大小不超过1M")])])],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(i){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:function(i){e.confirm(e.editingPublicDevice)}}},[e._v("确 定")])],1)]),e._v(" "),t("el-dialog",{attrs:{title:"删除",visible:e.dialogVisible_remove,width:"30%","before-close":e.handleClose},on:{"update:visible":function(i){e.dialogVisible_remove=i}}},[e._v("\n    确认删除后, 用户APP相关展示信息将会同步删除且不可恢复!\n    "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(i){e.dialogVisible_remove=!1}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:function(i){e.confirm2(e.editingPublicDevice)}}},[e._v("确 定")])],1)]),e._v(" "),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[t("el-table-column",{attrs:{label:"ID",prop:"id"}}),e._v(" "),t("el-table-column",{attrs:{label:"名称",prop:"facilityName"}}),e._v(" "),t("el-table-column",{attrs:{label:"图片(40X40)"},scopedSlots:e._u([{key:"default",fn:function(e){return[t("div",{staticClass:"tablePic",style:"background-image: url("+e.row.facilityIconUrl+"); background-size: 100% 100%"})]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"c284f6ce-effb-4183-bede-b696153e2792",expression:"'c284f6ce-effb-4183-bede-b696153e2792'"}],attrs:{size:"small"},nativeOn:{click:function(t){e.showDialog(i.row)}}},[e._v("编辑")])]}}])})],1)],1)},staticRenderFns:[]};var r={components:{StoreConfigTable:t("VU/8")(n,c,!1,function(e){t("A7L9")},"data-v-43fa2ed3",null).exports},data:function(){return{dialogVisible:!1,facilityName:"",uploadImgUrl:""}},computed:o()({},Object(l.e)({storeConfigPublicDevice:function(e){return e.storeConfig.storeConfigPublicDevice},isFetchingData:function(e){return e.storeConfig.isFetchingData}})),methods:o()({},Object(l.b)(["getStoreConfigPublicDevice","storeConfigUploadImg","updateStoreConfigPublicDevice"]),{handleClose:function(e){e()},addPublicDevice:function(){this.dialogVisible=!0},handlePreview:function(){},handleRemove:function(){},submitUpload:function(){this.$refs.upload.submit()},upLoadImg:function(e){this.$notify.warning("图片正在上传, 请耐心等待");var i=this,t="",a=new FileReader;a.readAsDataURL(e.file),a.onloadend=function(){t=this.result;var a=e.file.name.split("."),o=a[a.length-1];i.storeConfigUploadImg({imageBase64:t,type:o}).then(function(e){i.uploadImgUrl=e,i.isLoadingImgSuccess=!0,i.$notify.success("图片加载成功")}).catch(function(e){i.$notify.error("图片加载失败, 请重试"),i.isLoadingImgSuccess=!1})}},beforeUploadImg:function(e){var i="image/jpeg"===e.type||"image/png"===e.type,t=e.size/1024/1024<1;return i||this.$notify.error("上传图片只能是 JPG或PNG 格式!"),t||this.$notify.error("上传图片大小不能超过 1MB!"),i&&t},confirm:function(){var e=this;this.updateStoreConfigPublicDevice({name:this.facilityName,imageUrl:this.uploadImgUrl,typeStr:"0"}).then(function(){e.$notify.success("公共设备["+e.facilityName+"]添加成功"),e.dialogVisible=!1,e.getStoreConfigPublicDevice()}).catch(function(){e.$notify.error("公共设备["+e.facilityName+"]添加失败, 请重试"),e.dialogVisible=!1})}}),beforeRouteEnter:function(e,i,t){t(function(e){e.$nextTick(function(){e.getStoreConfigPublicDevice()})})},mounted:function(){var e=this;this.$nextTick(function(){e.getStoreConfigPublicDevice()})}},u={render:function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("div",{staticClass:"protalPage"},[t("el-dialog",{attrs:{title:"添加",visible:e.dialogVisible,width:"30%","before-close":e.handleClose},on:{"update:visible":function(i){e.dialogVisible=i}}},[t("div",{staticClass:"subTitle"},[t("div",{staticClass:"subsubTitle"},[e._v("名称:")]),e._v(" "),t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"输入名称",clearable:""},model:{value:e.facilityName,callback:function(i){e.facilityName=i},expression:"facilityName"}})],1),e._v(" "),t("div",{staticClass:"uploadBox"},[t("el-upload",{ref:"upload",staticClass:"avatar-uploader",attrs:{action:"http://api-control.test.hxsapp.com/admin/Upload/uploadBase64","on-preview":e.handlePreview,"on-remove":e.handleRemove,"list-type":"picture-card","auto-upload":!0,"http-request":e.upLoadImg,"show-file-list":!1,"before-upload":e.beforeUploadImg}},[e.uploadImgUrl?t("img",{staticClass:"avatar",attrs:{src:e.uploadImgUrl}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon imgborder"})]),e._v(" "),t("div",{staticClass:"uploadTips"},[t("div",[e._v("尺寸: 40X40")]),e._v(" "),t("div",[e._v("支持JPG/PNG格式")]),e._v(" "),t("div",[e._v("大小不超过1M")])])],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(i){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确 定")])],1)]),e._v(" "),t("div",{staticClass:"storeConfigPage"},[t("div",{staticClass:"title"},[e._v("门店配置")]),e._v(" "),t("div",{staticClass:"tableTitle"},[t("div",{staticClass:"subTitle"},[e._v("公共设备标签")]),e._v(" "),t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"e1b7ed1e-270a-4b82-8858-976b9f595ce7",expression:"'e1b7ed1e-270a-4b82-8858-976b9f595ce7'"}],attrs:{type:"primary"},nativeOn:{click:function(i){e.addPublicDevice(i)}}},[e._v("添加")])],1),e._v(" "),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isFetchingData,expression:"isFetchingData"}],staticClass:"tableBox"},[t("store-config-table",{directives:[{name:"permission",rawName:"v-permission",value:"a9647377-9fbc-4024-b350-3060b2e9162c",expression:"'a9647377-9fbc-4024-b350-3060b2e9162c'"}],attrs:{tableData:e.storeConfigPublicDevice}})],1)])],1)},staticRenderFns:[]};var d=t("VU/8")(r,u,!1,function(e){t("6qLU")},"data-v-5e56efd7",null);i.default=d.exports},"6qLU":function(e,i){},A7L9:function(e,i){}});
//# sourceMappingURL=33.4050d7229c246f0f607d.js.map