webpackJsonp([57],{"3Vlc":function(e,t){},w1f0:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("hA+o"),s={data:function(){return{userId:"",userName:"",userPhone:"",currentPage:1,currentSize:10,curTotal:0,userPlans:[],tariningStatus:0,cycleNum:"all",cycleOptions:[{value:"all",label:"全部"},{value:"2",label:"2周"},{value:"3",label:"3周"},{value:"4",label:"4周"}],statusOptions:[{label:"全部",value:0},{label:"进行中",value:1},{label:"已过期",value:2},{label:"已终止",value:3}],percentMin:"",percentMax:"",percentLabel:"全部",customPercent:{isCustom:!0,max:"",min:""},percentOptions:[{command:{max:1,min:0},label:"全部"},{command:{max:1,min:.8},label:"80%-100%"},{command:{max:.8,min:.6},label:"60%-80%"},{command:{max:.6,min:.4},label:"40%-60%"},{command:{max:.4,min:.2},label:"20%-40%"},{command:{max:.2,min:0},label:"0%-20%"}],isLoadingData:!1}},components:{SubTitle:a("0LZo").a},watch:{cycleNum:function(){this.fetchPlanList()},tariningStatus:function(){this.fetchPlanList()},percentMin:function(){this.fetchPlanList()}},methods:{handleSizeChange:function(e){this.currentSize=e,this.fetchPlanList()},handleCurrentChange:function(e){this.currentPage=e,this.fetchPlanList()},handleClick:function(e,t){e&&(this.percentLabel=e.label,this.percentMin=e.command.min,this.percentMax=e.command.max,this.customPercent.min="",this.customPercent.max="")},custom:function(){if(this.customPercent.min&&this.customPercent.max)if(!isNaN(Number(this.customPercent.min))&&!isNaN(Number(this.customPercent.max))&&/^\d+$/.test(this.customPercent.max)&&/^\d+$/.test(this.customPercent.min)){if(this.customPercent.min>=this.customPercent.max)return this.$notify.error("起始百分比应小于结束百分比"),this.customPercent.min="",void(this.customPercent.max="");this.percentLabel=parseInt(this.customPercent.min)+"%-"+parseInt(this.customPercent.max)+"%",this.percentMin=parseInt(this.customPercent.min)/100,this.percentMax=parseInt(this.customPercent.max)/100}else this.$notify.error("请输入整数");else this.$notify.error("输入不能为空")},jumpTo:function(e){this.$router.push({path:"/user/userPlanDetail?userTrainId="+e.id+"&userId="+e.userId+"&nickname="+e.userInfo.nickname+"&mobile="+e.userInfo.mobile})},createParams:function(){var e={};return this.userId||this.userName||this.userPhone?e.page=1:e.page=this.currentPage,e.size=this.currentSize,this.userId&&(e.userId=this.userId),this.userName&&(e.nickName=this.userName),this.userPhone&&(e.phone=this.userPhone),(this.percentMin||this.percentMax)&&(e.percentMin=this.percentMin,e.percentMax=this.percentMax),"all"!=this.cycleNum&&(e.cycleId=this.cycleNum),e.trainStatus=this.tariningStatus,e},mapPagination:function(e){if(!e)return this.currentPage=1,this.currentSize=10,void(this.curTotal=0);this.currentPage=e.pageNum<1?1:e.pageNum,this.currentSize=e.pageSize,this.curTotal=e.total},fetchPlanList:function(){var e=this;this.isLoadingData=!0,Object(n.c)(this.createParams()).then(function(t){e.userPlans=t.data?t.data.data.list:[],e.mapPagination(t.data.data),e.isLoadingData=!1}).catch(function(){e.isLoadingData=!1})}},beforeRouteEnter:function(e,t,a){a(function(e){e.$nextTick(function(){e.fetchPlanList()})})},mounted:function(){var e=this;this.$nextTick(function(){e.fetchPlanList()})}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"userPlanPage"},[a("sub-title",{attrs:{title:"用户训练计划"}}),e._v(" "),a("div",{staticClass:"selectors",staticStyle:{"margin-top":"20px"}},[a("el-input",{staticStyle:{width:"200px","margin-right":"10px"},attrs:{placeholder:"搜索用户昵称"},model:{value:e.userName,callback:function(t){e.userName=t},expression:"userName"}}),e._v(" "),a("el-input",{staticStyle:{width:"200px","margin-right":"10px"},attrs:{placeholder:"搜索用户手机号"},model:{value:e.userPhone,callback:function(t){e.userPhone=t},expression:"userPhone"}}),e._v(" "),a("el-input",{staticStyle:{width:"200px","margin-right":"10px"},attrs:{placeholder:"搜索用户ID"},model:{value:e.userId,callback:function(t){e.userId=t},expression:"userId"}}),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.fetchPlanList}},[e._v("搜索")])],1),e._v(" "),a("div",{staticClass:"selectors",staticStyle:{"margin-top":"20px"}},[a("div",{staticClass:"selector_item"},[a("div",{staticClass:"selector_item_title"},[e._v("周数")]),e._v(" "),a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.cycleNum,callback:function(t){e.cycleNum=t},expression:"cycleNum"}},e._l(e.cycleOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("div",{staticClass:"selector_item"},[a("div",{staticClass:"selector_item_title"},[e._v("状态")]),e._v(" "),a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.tariningStatus,callback:function(t){e.tariningStatus=t},expression:"tariningStatus"}},e._l(e.statusOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("div",{staticClass:"selector_item"},[a("div",{staticClass:"selector_item_title"},[e._v("完成")]),e._v(" "),a("el-dropdown",{attrs:{"split-button":"",trigger:"click","hide-on-click":!1},on:{command:e.handleClick}},[e._v("\n        "+e._s(e.percentLabel)+"\n        "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e._l(e.percentOptions,function(t,n){return a("el-dropdown-item",{key:n,attrs:{command:t}},[e._v(e._s(t.label))])}),e._v(" "),a("el-dropdown-item",{attrs:{command:!1}},[a("div",[e._v("自定义")]),e._v(" "),a("el-input",{staticStyle:{width:"110px"},model:{value:e.customPercent.min,callback:function(t){e.$set(e.customPercent,"min",t)},expression:"customPercent.min"}},[a("template",{slot:"append"},[e._v("%")])],2),e._v("\n            至\n            "),a("el-input",{staticStyle:{width:"110px"},model:{value:e.customPercent.max,callback:function(t){e.$set(e.customPercent,"max",t)},expression:"customPercent.max"}},[a("template",{slot:"append"},[e._v("%")])],2),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},nativeOn:{click:function(t){t.stopPropagation(),e.custom(t)}}},[e._v("确认")])],1)],2)],1)],1)]),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoadingData,expression:"isLoadingData"},{name:"permission",rawName:"v-permission",value:"94524f86-56a4-4575-9b54-66bb6b1e2e0c",expression:"'94524f86-56a4-4575-9b54-66bb6b1e2e0c'"}],staticClass:"tableBox"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.userPlans}},[a("el-table-column",{attrs:{label:"时间",prop:"createTime"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e.moment(t.row.createTime).format("YYYY-MM-DD HH:mm:ss"))+"\n          ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"用户ID",prop:"userId"}}),e._v(" "),a("el-table-column",{attrs:{label:"用户昵称",prop:"userInfo.nickname"}}),e._v(" "),a("el-table-column",{attrs:{label:"性别"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(1==t.row.userInfo.sex?"男":"女")+"\n          ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"手机",prop:"userInfo.mobile"}}),e._v(" "),a("el-table-column",{attrs:{label:"训练计划名称",prop:"planName"}}),e._v(" "),a("el-table-column",{attrs:{label:"周数",prop:"cityName"}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",prop:"trainStatus"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n             "+e._s(1==t.row.trainStatus?"进行中":2==t.row.trainStatus?"已过期":3==t.row.trainStatus?"已终止":"未开始")+"\n           ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"完成",prop:"completePercent"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n             "+e._s(100*parseFloat(t.row.completePercent)+"%")+"\n           ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"8d81f81c-e072-4708-9cc4-9be155448d46",expression:"'8d81f81c-e072-4708-9cc4-9be155448d46'"}],attrs:{type:"primary",plain:""},on:{click:function(a){e.jumpTo(t.row)}}},[e._v("查看")])]}}])})],1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:e.curTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var l=a("VU/8")(s,i,!1,function(e){a("3Vlc")},"data-v-42ba6172",null);t.default=l.exports}});
//# sourceMappingURL=57.fae780f2be05c83f4a71.js.map