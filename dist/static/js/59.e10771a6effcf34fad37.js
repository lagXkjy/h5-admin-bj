webpackJsonp([59],{g0DH:function(t,e){},menA:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("F+jZ"),n=i("GgUn"),a={name:"addBulletin",data:function(){return{storeId:0,stores:[],time:[],bulletinTitle:"",bulletinContent:""}},computed:{userInfo:function(){return this.$store.state.auth.userInformation},isNowDate:function(){var t=this.moment().format("YYYY-MM-DD"),e=this.time[0];return!!e&&e.split(" ")[0]===t},selectedDate:function(){return this.time[0].split(" ")[0]},storeName:function(){var t=this;return this.stores.length<1?"":this.stores.find(function(e){return e.id==t.storeId}).storeName}},methods:{setDefaultDate:function(){var t=this.moment().format("YYYY-MM-DD HH:mm:ss"),e=this.moment(t).add(3,"days").format("YYYY-MM-DD HH:mm:ss");this.time=[t,e]},fetchDropDownStores:function(){var t=this;Object(s.b)().then(function(e){e.unshift({id:0,storeName:"全部门店"}),t.stores=e}).catch(function(){t.$notify.error("获取门店菜单失败")})},successUpload:function(t,e,i){},failedUpload:function(t,e,i){},verify:function(){return this.time.length<1||new Date(this.selectedDate).getTime()<new Date(this.moment().format("YYYY-MM-DD")).getTime()?(this.$notify.error("请选择当前日期(或以后)为起始的日期区间"),!1):this.bulletinTitle.trim()?!!this.bulletinContent.trim()||(this.$notify.error("请输入公告内容"),!1):(this.$notify.error("请输入公告标题"),!1)},createParams:function(){var t={};return"all"!==this.storeId&&(t.storeId=this.storeId,t.storeName=this.storeName),t.adminId=this.userInfo.id,t.isLatest=0,t.startTime=this.time[0],t.endTime=this.time[1],t.topic=this.bulletinTitle,t.topicContent=this.bulletinContent,t.adminName=this.userInfo.username,t.status=this.isNowDate?1:2,t},create:function(){var t=this;this.verify()&&Object(n.a)(this.createParams()).then(function(e){200===e.data.code?(t.$notify.success("发布成功"),t.$router.push({path:"/storePart/storeBulletin"})):t.$notify.error(e.data.message||"发布失败, 请尝试重新发布")}).catch(function(){t.$notify.error("发布失败, 请尝试重新发布")})}},mounted:function(){var t=this;this.$nextTick(function(){t.setDefaultDate(),t.fetchDropDownStores()})}},r={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"protalPage"},[i("div",{staticClass:"storeBulletinPage"},[i("div",{staticClass:"title"},[t._v("\n      发布公告\n    ")]),t._v(" "),i("div",{staticClass:"form_item"},[i("div",{staticClass:"form_item_title"},[t._v("门店")]),t._v(" "),i("el-select",{attrs:{placeholder:"请选择"},model:{value:t.storeId,callback:function(e){t.storeId=e},expression:"storeId"}},t._l(t.stores,function(t){return i("el-option",{key:t.id,attrs:{label:t.storeName,value:t.id}})}))],1),t._v(" "),i("div",{staticClass:"form_item"},[i("div",{staticClass:"form_item_title"},[t._v("有效期")]),t._v(" "),i("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd HH:mm:ss","default-time":["00:00:00","23:59:59"]},model:{value:t.time,callback:function(e){t.time=e},expression:"time"}})],1),t._v(" "),i("div",{staticClass:"form_item"},[i("div",{staticClass:"form_item_title"},[t._v("公告标题")]),t._v(" "),i("el-input",{attrs:{placeholder:"输入公告标题",maxlength:"20"},model:{value:t.bulletinTitle,callback:function(e){t.bulletinTitle=e},expression:"bulletinTitle"}})],1),t._v(" "),i("div",{staticClass:"form_item"},[i("div",{staticClass:"form_item_title"},[t._v("公告内容")]),t._v(" "),i("el-input",{attrs:{placeholder:"输入公告内容",type:"textarea",maxlength:"1000"},model:{value:t.bulletinContent,callback:function(e){t.bulletinContent=e},expression:"bulletinContent"}})],1),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.create}},[t._v("确认发布")])],1)])},staticRenderFns:[]};var o=i("VU/8")(a,r,!1,function(t){i("g0DH")},"data-v-3d228da4",null);e.default=o.exports}});
//# sourceMappingURL=59.e10771a6effcf34fad37.js.map