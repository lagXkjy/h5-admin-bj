webpackJsonp([60],{E4aq:function(e,t){},fPVx:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Dd8w"),s=a.n(r),i=a("af4Q"),n=a("NYxO"),o=a("JaHG"),l={data:function(){return{userName:"",userId:"",store:"all",dialogVisible:!1,isLoading:!1,currentPage:1,pageSizes:[10,20,30,40],curPageSize:10,curTotal:0,currentSize2:10,currentPage2:1,curTotal2:0,userTopList:[],followers:[],currentItem:{}}},computed:s()({},Object(n.e)({dropdownStoreList:function(e){return e.userTop.dropdownStoreList}}),{storeList:function(){var e=Object(o.b)(this.dropdownStoreList);return e.unshift({storeName:"全部门店",id:"all"}),e},datas:function(){if(!this.userTopList)return[];var e=Object(o.b)(this.userTopList);return e.forEach(function(e,t){e.username=e.userInfo.nickname,e.sportLength=(e.sportLength/60).toFixed(2),e.favorNum=e.favorNum+"次"}),e}}),watch:{store:function(e){this.fetchData()}},methods:s()({},Object(n.b)(["getUserTopList","getDropDownStoreList"]),{checkout:function(e){this.currentItem=e,this.dialogVisible=!0,this.currentPage2=1,this.currentSize2=10,this.getFollowers(e)},getFollowers:function(e){var t=this;Object(i.a)({page:this.currentPage2,size:this.currentSize2,byUserId:e.userId}).then(function(e){e.data.data.list.forEach(function(e,a){e.createTime=t.moment(e.createTime).format("YYYY-MM-DD HH:mm:ss")}),t.followers=e.data.data.list,t.mapPagination2(e.data.data)})},handleClose:function(e){e()},jumpToUserDetail:function(e){this.$router.push({path:"/user/userList?userDetail="+e})},createParams:function(){var e={};return"all"!==this.store&&(e.storeId=this.store),this.userName&&(e.userName=this.userName),this.userId&&(e.userId=this.userId),this.userName||this.userId?e.page=1:e.page=this.currentPage,e.size=this.curPageSize,e},mapPagination2:function(e){this.currentPage=e.pageNum<1?1:e.pageNum,this.currentSize2=e.pageSize,this.curTotal2=e.total},mapPagination:function(e){this.currentPage2=e.pageNum<1?1:e.pageNum,this.curPageSize=e.pageSize,this.curTotal=e.total},fetchData:function(){var e=this;this.isLoading=!0,this.getUserTopList(this.createParams()).then(function(t){e.isLoading=!1,e.userTopList=t.list,e.mapPagination(t)}).catch(function(){e.isLoading=!1})},handleSizeChange:function(e){this.curPageSize=e,this.fetchData()},handleCurrentChange:function(e){this.currentPage=e,this.fetchData()},handleCurrentChange2:function(e){this.currentPage2=e,this.getFollowers(this.currentItem)},handleSizeChange2:function(e){this.currentSize2=e,this.getFollowers(this.currentItem)}}),beforeRouteEnter:function(e,t,a){a(function(e){e.$nextTick(function(){e.fetchData()})})},mounted:function(){var e=this;this.$nextTick(function(){e.getDropDownStoreList({page:1,size:100}),e.fetchData()})}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"protalPage"},[a("div",{staticClass:"userTopPage"},[a("div",{staticClass:"title"},[e._v("\n      运动排行榜\n    ")]),e._v(" "),a("div",{staticClass:"selector",staticStyle:{"padding-top":"30px"}},[a("span",[e._v("门店")]),e._v(" "),a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.store,callback:function(t){e.store=t},expression:"store"}},e._l(e.storeList,function(e){return a("el-option",{key:e.id,attrs:{label:e.storeName,value:e.id}})})),e._v(" "),a("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"搜索用户昵称"},model:{value:e.userName,callback:function(t){e.userName=t},expression:"userName"}}),e._v(" "),a("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"搜索用户ID"},model:{value:e.userId,callback:function(t){e.userId=t},expression:"userId"}}),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.fetchData}},[e._v("搜索")])],1),e._v(" "),a("div",{directives:[{name:"permission",rawName:"v-permission",value:"aaf5510a-7394-4071-9b82-8ad85ecd04af",expression:"'aaf5510a-7394-4071-9b82-8ad85ecd04af'"}],staticClass:"userTop"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticStyle:{width:"100%"},attrs:{data:e.datas}},[a("el-table-column",{attrs:{label:"排名",prop:"sortNum",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{label:"用户ID",prop:"userId",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{label:"用户",prop:"username",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{attrs:{href:"javascript:;"},on:{click:function(a){e.jumpToUserDetail(t.row.userId)}}},[e._v(e._s(t.row.username))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"门店",prop:"storeName"}}),e._v(" "),a("el-table-column",{attrs:{label:"运动总时长",prop:"sportLength"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.sportLength+"分钟"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"被点赞总数"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.favorNum))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"6ed99d9e-d1d9-4c95-b9bc-67e61acff7ca",expression:"'6ed99d9e-d1d9-4c95-b9bc-67e61acff7ca'"}],on:{click:function(a){e.checkout(t.row)}}},[e._v("查看被点赞详情")])]}}])})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"被点赞记录",center:"",visible:e.dialogVisible,width:"60%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{staticClass:"followerHeader"},[a("div",{staticClass:"rank"},[a("div",{staticStyle:{"text-align":"center","font-size":"30px"}},[e._v(e._s(e.currentItem.sortNum))]),a("div",[e._v("排名")])]),e._v(" "),a("div",{staticClass:"username",staticStyle:{"text-align":"center","font-size":"30px"}},[e._v(e._s(e.currentItem.username))]),e._v(" "),a("div",{staticClass:"sportLength"},[a("div",{staticStyle:{"text-align":"center","font-size":"30px"}},[e._v(e._s(e.currentItem.sportLength))]),a("div",{staticStyle:{"text-align":"center"}},[e._v("运动分钟")])])]),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.followers}},[a("el-table-column",{attrs:{label:"序号",prop:"number"}}),e._v(" "),a("el-table-column",{attrs:{label:"日期",prop:"createTime"}}),e._v(" "),a("el-table-column",{attrs:{label:"用户"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{attrs:{href:"javascript:;"},on:{click:function(a){e.jumpToUserDetail(t.row.userId)}}},[e._v(e._s(t.row.userName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"为ta点赞"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n             第"+e._s(t.row.sortNum)+"个\n          ")]}}])})],1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.currentPage2,"page-sizes":[10,20,30,40],"page-size":e.currentSize2,layout:"total, sizes, prev, pager, next, jumper",total:e.curTotal2},on:{"size-change":e.handleSizeChange2,"current-change":e.handleCurrentChange2}})],1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":e.pageSizes,"page-size":e.curPageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.curTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])},staticRenderFns:[]};var c=a("VU/8")(l,u,!1,function(e){a("E4aq")},"data-v-324a4ed2",null);t.default=c.exports}});
//# sourceMappingURL=60.0921c67b95f88144634e.js.map