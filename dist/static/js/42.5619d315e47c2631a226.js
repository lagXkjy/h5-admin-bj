webpackJsonp([42],{Uckl:function(t,i){},oDtc:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=e("0LZo"),a=e("uGdK"),n={name:"personnelConfig",data:function(){return{id:null,role:"",roles:[],username:"",realName:"",mobile:"",email:"",password:"",newPassword:"",newPassword_repeat:"",displayStatus:1,isFetchingRoles:!1}},computed:{roleName:function(){var t=this,i=this.roles.find(function(i){return i.id==t.role});return i?i.roleName:""}},components:{SubTitle:s.a},methods:{fetchRoles:function(){var t=this;Object(a.d)({page:1,size:1e3,isAdmin:0}).then(function(i){var e=i.data.data.list;t.$route.query.id||(e=e.filter(function(t){return 1!=t.isAdmin})),t.roles=e})},isPhoneAvailable:function(t){return!!/^[1][3,4,5,7,8,6,9][0-9]{9}$/.test(t)},addConfig:function(){var t=this;if(!this.role)return this.$notify.warning("请选择角色分类");if(!this.username)return this.$notify.warning("登录账号不能为空");if(!this.newPassword)return this.$notify.warning("登录密码不能为空");if(!this.email)return this.$notify.warning("邮箱不能为空");if(!this.realName)return this.$notify.warning("真实姓名不能为空");if(!this.mobile)return this.$notify.warning("手机号不能为空");if(this.email&&!new RegExp("^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$").test(this.email))return this.$notify.warning("请输入合法的邮箱");return this.mobile&&!this.isPhoneAvailable(this.mobile)?this.$notify.warning("请输入有效的手机号"):this.realName&&!/[\u4e00-\u9fa5]{2,6}/.test(this.realName)?this.$notify.warning("请输入2-6个汉字"):this.newPassword!==this.newPassword_repeat?this.$notify.warning("新旧密码不一致"):(this.$router.push({path:"/system/personnel"}),void Object(a.a)({roleId:this.role,roleName:this.roleName,username:this.username,email:this.email,password:this.newPassword,status:this.displayStatus,mobile:this.mobile,realName:this.realName,renew:this.$store.state.auth.userInformation.username,adminId:this.$store.state.auth.userInformation.id}).then(function(i){200==i.data.code?t.$notify.success("创建人员成功"):t.$notify.error(i.data.message||"创建人员失败")}).catch(function(){t.$notify.error("创建人员失败")}))},confirmEdit:function(){var t=this,i=void 0;if(!this.role)return this.$notify.warning("请选择角色分类");if(!this.username)return this.$notify.warning("登录账号不能为空");if(!this.email)return this.$notify.warning("邮箱不能为空");if(!this.realName)return this.$notify.warning("真实姓名不能为空");if(!this.mobile)return this.$notify.warning("手机号不能为空");if(this.email&&!new RegExp("^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$").test(this.email))return this.$notify.warning("请输入合法的邮箱");if(this.mobile&&!this.isPhoneAvailable(this.mobile))return this.$notify.warning("请输入有效的手机号");if(this.realName&&!/[\u4e00-\u9fa5]{2,6}/.test(this.realName))return this.$notify.warning("请输入2-6个汉字");if(this.newPassword){if(this.newPassword!==this.newPassword_repeat)return void this.$notify.warning("新旧密码不一致");i={id:this.id,roleId:this.role,username:this.username,email:this.email,mobile:this.mobile,password:this.newPassword,status:this.displayStatus,realName:this.realName}}else i={id:this.id,roleId:this.role,username:this.username,email:this.email,mobile:this.mobile,status:this.displayStatus,realName:this.realName};this.$router.push({path:"/system/personnel"}),Object(a.e)(i).then(function(i){200==i.data.code?t.$notify.success("修改成功"):t.$notify.error(i.data.message||"修改失败")}).catch(function(){t.$notify.error("修改失败, 请重试")})},switchChange:function(){},resetInfo:function(){this.username="",this.email="",this.password="",this.realName="",this.mobile="",this.displayStatus=1,this.id=null},fetchDetail:function(){var t=this;Object(a.b)({id:this.$route.query.id}).then(function(i){var e=i.data.data;t.username=e.username,t.email=e.email,t.password=e.password,t.realName=e.realName,t.role=e.roleId,t.mobile=e.mobile,t.displayStatus=e.isValid,t.id=e.id})}},mounted:function(){var t=this;this.$nextTick(function(){t.$route.query.id?t.fetchDetail():t.resetInfo(),t.fetchRoles()})}},r={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"personnelConfigPage"},[e("sub-title",{attrs:{title:"人员管理配置"}}),t._v(" "),e("div",{staticClass:"config_content"},[e("div",{staticClass:"config_item"},[e("div",{staticClass:"config_item_subtitle"},[t._v("角色分类")]),t._v(" "),e("div",[e("el-select",{directives:[{name:"loading",rawName:"v-loading",value:t.isFetchingRoles,expression:"isFetchingRoles"}],staticStyle:{"margin-right":"20px"},attrs:{placeholder:"请选择","element-loading-spinner":"el-icon-loading"},model:{value:t.role,callback:function(i){t.role=i},expression:"role"}},t._l(t.roles,function(t){return e("el-option",{key:t.id,attrs:{label:t.roleName,value:t.id}})}))],1)]),t._v(" "),e("div",{staticClass:"config_item"},[e("div",{staticClass:"config_item_subtitle"},[t._v("登录账号")]),t._v(" "),e("div",[e("el-input",{staticStyle:{width:"500px"},model:{value:t.username,callback:function(i){t.username=i},expression:"username"}})],1)]),t._v(" "),e("div",{staticClass:"config_item"},[e("div",{staticClass:"config_item_subtitle"},[t._v("真实姓名")]),t._v(" "),e("div",[e("el-input",{staticStyle:{width:"500px"},model:{value:t.realName,callback:function(i){t.realName=i},expression:"realName"}})],1)]),t._v(" "),e("div",{staticClass:"config_item"},[e("div",{staticClass:"config_item_subtitle"},[t._v("手机号码")]),t._v(" "),e("div",[e("el-input",{staticStyle:{width:"500px"},model:{value:t.mobile,callback:function(i){t.mobile=i},expression:"mobile"}})],1)]),t._v(" "),e("div",{staticClass:"config_item"},[e("div",{staticClass:"config_item_subtitle"},[t._v("邮箱")]),t._v(" "),e("div",[e("el-input",{staticStyle:{width:"500px"},model:{value:t.email,callback:function(i){t.email=i},expression:"email"}})],1)]),t._v(" "),e("div",{staticClass:"config_item"},[e("div",{staticClass:"config_item_subtitle"},[t._v("新密码")]),t._v(" "),e("div",[e("el-input",{staticStyle:{width:"500px"},attrs:{type:"password"},model:{value:t.newPassword,callback:function(i){t.newPassword=i},expression:"newPassword"}})],1)]),t._v(" "),t.newPassword?e("div",{staticClass:"config_item"},[e("div",{staticClass:"config_item_subtitle"},[t._v("确认密码")]),t._v(" "),e("div",[e("el-input",{staticStyle:{width:"500px"},attrs:{type:"password"},model:{value:t.newPassword_repeat,callback:function(i){t.newPassword_repeat=i},expression:"newPassword_repeat"}})],1)]):t._e(),t._v(" "),e("div",{staticClass:"config_item"},[e("div",{staticClass:"config_item_subtitle"},[t._v("是否启用")]),t._v(" "),e("div",[e("el-switch",{attrs:{"active-value":1,"inactive-value":0},on:{change:t.switchChange},model:{value:t.displayStatus,callback:function(i){t.displayStatus=i},expression:"displayStatus"}})],1)])]),t._v(" "),e("div",{staticClass:"button_bottom"},[t.id?e("el-button",{attrs:{type:"primary"},on:{click:t.confirmEdit}},[t._v("确认修改")]):e("el-button",{attrs:{type:"primary"},on:{click:t.addConfig}},[t._v("确认新增")])],1)],1)},staticRenderFns:[]};var o=e("VU/8")(n,r,!1,function(t){e("Uckl")},"data-v-32f8bb30",null);i.default=o.exports},uGdK:function(t,i,e){"use strict";i.c=function(t){return s.a.post("admin/Jurisdiction/getListByParamUser",t)},i.d=function(t){return s.a.post("admin/Jurisdiction/getListByParamRole",t)},i.b=function(t){return s.a.post("admin/User/managerDetail",t)},i.e=function(t){return s.a.post("admin/User/managerUpdate",t)},i.a=function(t){return s.a.post("admin/User/register",t)};var s=e("RyKi")}});
//# sourceMappingURL=42.5619d315e47c2631a226.js.map